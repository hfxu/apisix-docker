{"plugins":{"consumer-restriction":{"version":0.1,"priority":2400,"schema":{"anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"type":{"type":"string","default":"consumer_name","enum":["consumer_name","service_id","route_id","consumer_group_id"]},"blacklist":{"minItems":1,"type":"array","items":{"type":"string"}},"whitelist":{"minItems":1,"type":"array","items":{"type":"string"}},"allowed_by_methods":{"items":{"properties":{"user":{"type":"string"},"methods":{"minItems":1,"type":"array","items":{"type":"string","description":"HTTP method","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"]}}},"type":"object"},"type":"array"},"rejected_code":{"type":"integer","default":403,"minimum":200},"rejected_msg":{"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"ai":{"version":0.1,"priority":22900,"scope":"global","schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"traffic-split":{"version":0.1,"priority":966,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"rules":{"items":{"properties":{"weighted_upstreams":{"type":"array","default":[{"weight":1}],"items":{"properties":{"upstream_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"weight":{"default":1,"type":"integer","description":"used to split traffic between differentupstreams for plugin configuration","minimum":0},"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","properties":{"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"}}},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}},"type":"object"},{"items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"type":"integer","description":"priority of node","default":0},"metadata":{"description":"metadata of node","type":"object"},"port":{"type":"integer","description":"port of node","minimum":1},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"type":"integer","description":"weight of node","minimum":0}}},"type":"array"}]},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"not":{"required":["client_cert_id"]},"required":["client_key"]},"client_key":{"not":{"required":["client_cert_id"]},"required":["client_cert"]}},"type":"object","properties":{"verify":{"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false},"client_key":{"minLength":128,"type":"string","maxLength":65536},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_cert_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"type":{"type":"string","description":"algorithms of load balancing","default":"roundrobin"},"name":{"minLength":1,"maxLength":100,"type":"string"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}},"type":"object"},"keepalive_pool":{"properties":{"requests":{"type":"integer","default":1000,"minimum":1},"idle_timeout":{"type":"number","default":60,"minimum":0},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"pass_host":{"default":"pass","type":"string","description":"mod of host passing","enum":["pass","node","rewrite"]},"create_time":{"type":"integer"},"scheme":{"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"]},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"active":{"properties":{"unhealthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"maximum":254,"type":"integer","default":3,"minimum":1},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":1},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":1}},"type":"object"},"req_headers":{"minItems":1,"type":"array","items":{"uniqueItems":true,"type":"string"}},"timeout":{"default":1,"type":"number"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"successes":{"maximum":254,"type":"integer","default":2,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,302]}},"type":"object"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"type":"integer","default":7,"minimum":0},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":0},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,500,503]},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":0}},"type":"object"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"maximum":254,"type":"integer","default":5,"minimum":0}},"type":"object"}},"type":"object"}}},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}}},"type":"object"},"minItems":1,"maxItems":20},"match":{"items":{"properties":{"vars":{"type":"array"}},"type":"object"},"type":"array"}},"type":"object"},"type":"array"}}}},"referer-restriction":{"version":0.1,"priority":2990,"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"message":{"minLength":1,"type":"string","default":"Your referer host is not allowed","maxLength":1024},"blacklist":{"type":"array","minItems":1,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"bypass_missing":{"default":false,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"whitelist":{"type":"array","minItems":1,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}}}}},"response-rewrite":{"version":0.1,"priority":899,"schema":{"dependencies":{"filters":{"not":{"required":["body"]}},"body":{"not":{"required":["filters"]}}},"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"body_base64":{"type":"boolean","description":"whether new body for response need base64 decode before return","default":false},"body":{"description":"new body for response","type":"string"},"status_code":{"maximum":598,"type":"integer","description":"new status code for response","minimum":200},"headers":{"description":"new headers for response","anyOf":[{"minProperties":1,"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}}},{"properties":{"set":{"minProperties":1,"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}}},"remove":{"minItems":1,"type":"array","items":{"pattern":"^[^:]+$","type":"string"}},"add":{"minItems":1,"type":"array","items":{"pattern":"^[^:]+:[^:]+[^/]$","type":"string"}}}}]},"filters":{"minItems":1,"type":"array","description":"a group of filters that modify response bodyby replacing one specified string by another","items":{"required":["regex","replace"],"type":"object","description":"filter that modifies response body","properties":{"options":{"type":"string","description":"regex options","default":"jo"},"replace":{"description":"regex substitution content","type":"string"},"scope":{"default":"once","type":"string","description":"regex substitution range","enum":["once","global"]},"regex":{"minLength":1,"type":"string","description":"match pattern on response body"}}}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"vars":{"type":"array"}}}},"body-transformer":{"version":0.1,"schema":{"anyOf":[{"required":["request"]},{"required":["response"]},{"required":["request","response"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"request":{"type":"object","required":["template"],"properties":{"input_format":{"enum":["xml","json"],"type":"string"},"template":{"type":"string"}}},"response":{"type":"object","required":["template"],"properties":{"input_format":{"enum":["xml","json"],"type":"string"},"template":{"type":"string"}}}}},"priority":1080},"client-control":{"version":0.1,"priority":22000,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"max_body_size":{"minimum":0,"type":"integer"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"datadog":{"version":0.1,"priority":495,"metadata_schema":{"properties":{"port":{"type":"integer","default":8125,"minimum":0},"namespace":{"default":"apisix","type":"string"},"host":{"default":"127.0.0.1","type":"string"},"constant_tags":{"type":"array","default":["source:apisix"],"items":{"type":"string"}}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"prefer_name":{"default":true,"type":"boolean"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"name":{"default":"datadog","type":"string"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"inactive_timeout":{"type":"integer","default":5,"minimum":1}}}},"openfunction":{"version":0.1,"priority":-1902,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["function_uri"],"properties":{"authorization":{"service_token":{"type":"string"}},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"timeout":{"type":"integer","default":3000,"minimum":100},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"function_uri":{"type":"string"},"keepalive":{"default":true,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"ssl_verify":{"default":true,"type":"boolean"}}}},"fault-injection":{"version":0.1,"priority":11000,"schema":{"minProperties":1,"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"delay":{"type":"object","required":["duration"],"properties":{"duration":{"minimum":0,"type":"number"},"vars":{"maxItems":20,"type":"array","items":{"type":"array"}},"percentage":{"type":"integer","maximum":100,"minimum":0}}},"abort":{"type":"object","required":["http_status"],"properties":{"vars":{"maxItems":20,"type":"array","items":{"type":"array"}},"body":{"minLength":0,"type":"string"},"http_status":{"minimum":200,"type":"integer"},"percentage":{"type":"integer","maximum":100,"minimum":0}}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"kafka-proxy":{"version":0.1,"priority":508,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","encrypt_fields":["sasl.password"],"properties":{"sasl":{"type":"object","required":["username","password"],"properties":{"username":{"type":"string"},"password":{"type":"string"}}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"ua-restriction":{"version":0.1,"priority":2999,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"message":{"minLength":1,"type":"string","default":"Not allowed","maxLength":1024},"bypass_missing":{"default":false,"type":"boolean"},"denylist":{"minItems":1,"type":"array","items":{"minLength":1,"type":"string"}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"allowlist":{"minItems":1,"type":"array","items":{"minLength":1,"type":"string"}}}}},"http-logger":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["uri"],"properties":{"include_resp_body":{"default":false,"type":"boolean"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"log_format":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"uri":{"pattern":"^[^\\/]+:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"retry_delay":{"type":"integer","default":1,"minimum":0},"name":{"default":"http logger","type":"string"},"auth_header":{"type":"string"},"concat_method":{"type":"string","default":"json","enum":["json","new_line"]},"ssl_verify":{"default":false,"type":"boolean"},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"timeout":{"type":"integer","default":3,"minimum":1},"include_req_body":{"default":false,"type":"boolean"}}},"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"priority":410},"openid-connect":{"version":0.2,"priority":2599,"schema":{"required":["client_id","client_secret","discovery"],"$comment":"this is a mark for our injected plugin schema","type":"object","encrypt_fields":["client_secret"],"properties":{"public_key":{"type":"string"},"token_signing_alg_values_expected":{"type":"string"},"timeout":{"description":"timeout in seconds","type":"integer","default":3,"minimum":1},"set_access_token_header":{"type":"boolean","description":"Whether the access token should be added as a header to the request for downstream","default":true},"access_token_in_authorization_header":{"type":"boolean","description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header.","default":false},"discovery":{"type":"string"},"client_secret":{"type":"string"},"set_userinfo_header":{"type":"boolean","description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream.","default":true},"scope":{"default":"openid","type":"string"},"client_id":{"type":"string"},"set_refresh_token_header":{"type":"boolean","description":"Whether the refresh token should be added in the X-Refresh-Token header to the request for downstream.","default":false},"bearer_only":{"default":false,"type":"boolean"},"session":{"required":["secret"],"type":"object","additionalProperties":false,"properties":{"secret":{"minLength":16,"type":"string","description":"the key used for the encrypt and HMAC calculation"}}},"ssl_verify":{"default":false,"type":"boolean"},"logout_path":{"default":"/logout","type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"redirect_uri":{"description":"use ngx.var.request_uri if not configured","type":"string"},"post_logout_redirect_uri":{"description":"the URI will be redirect when request logout_path","type":"string"},"set_id_token_header":{"type":"boolean","description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream.","default":true},"unauth_action":{"description":"The action performed when client is not authorized. Use auth to redirect user to identity provider, deny to respond with 401 Unauthorized, and pass to allow the request regardless.","type":"string","default":"auth","enum":["auth","deny","pass"]},"use_pkce":{"type":"boolean","description":"when set to true the PKEC(Proof Key for Code Exchange) will be used.","default":false},"introspection_endpoint_auth_method":{"default":"client_secret_basic","type":"string"},"introspection_endpoint":{"type":"string"},"realm":{"default":"apisix","type":"string"}}}},"api-breaker":{"version":0.1,"priority":1005,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["break_response_code"],"properties":{"max_breaker_sec":{"type":"integer","default":300,"minimum":3},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"healthy":{"type":"object","default":{"http_statuses":[200],"successes":3},"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":499,"minimum":200},"minItems":1,"default":[200]},"successes":{"type":"integer","default":3,"minimum":1}}},"unhealthy":{"type":"object","default":{"http_statuses":[500],"failures":3},"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":500},"minItems":1,"default":[500]},"failures":{"type":"integer","default":3,"minimum":1}}},"break_response_code":{"type":"integer","maximum":599,"minimum":200},"break_response_body":{"type":"string"},"break_response_headers":{"items":{"type":"object","required":["key","value"],"properties":{"value":{"minLength":1,"type":"string"},"key":{"minLength":1,"type":"string"}}},"type":"array"}}}},"opa":{"version":0.1,"priority":2001,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","policy"],"properties":{"timeout":{"type":"integer","default":3000,"maximum":60000,"description":"timeout in milliseconds","minimum":1},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"ssl_verify":{"default":true,"type":"boolean"},"keepalive":{"default":true,"type":"boolean"},"policy":{"type":"string"},"with_route":{"default":false,"type":"boolean"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"with_consumer":{"default":false,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"host":{"type":"string"},"with_service":{"default":false,"type":"boolean"}}}},"authz-casdoor":{"version":0.1,"priority":2559,"schema":{"required":["callback_url","endpoint_addr","client_id","client_secret"],"$comment":"this is a mark for our injected plugin schema","type":"object","encrypt_fields":["client_secret"],"properties":{"endpoint_addr":{"pattern":"^[^%?]+[^/]$","type":"string"},"client_secret":{"type":"string"},"client_id":{"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"callback_url":{"pattern":"^[^%?]+[^/]$","type":"string"}}}},"key-auth":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"hide_credentials":{"default":false,"type":"boolean"},"header":{"default":"apikey","type":"string"},"query":{"default":"apikey","type":"string"}}},"version":0.1,"consumer_schema":{"required":["key"],"type":"object","encrypt_fields":["key"],"properties":{"key":{"type":"string"}}},"type":"auth","priority":2500},"udp-logger":{"version":0.1,"priority":400,"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","port"],"properties":{"log_format":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"name":{"default":"udp logger","type":"string"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"port":{"minimum":0,"type":"integer"},"include_req_body":{"default":false,"type":"boolean"},"host":{"type":"string"},"timeout":{"type":"integer","default":3,"minimum":1}}}},"file-logger":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["path"],"properties":{"include_resp_body":{"default":false,"type":"boolean"},"path":{"type":"string"},"log_format":{"type":"object"},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"priority":399},"basic-auth":{"schema":{"title":"work with route or service object","type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"hide_credentials":{"default":false,"type":"boolean"}}},"version":0.1,"consumer_schema":{"title":"work with consumer object","type":"object","required":["username","password"],"encrypt_fields":["password"],"properties":{"username":{"type":"string"},"password":{"type":"string"}}},"type":"auth","priority":2520},"proxy-mirror":{"version":0.1,"priority":1010,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host"],"properties":{"path_concat_mode":{"description":"the concatenation mode for custom path","type":"string","default":"replace","enum":["replace","prefix"]},"sample_ratio":{"maximum":1,"type":"number","default":1,"minimum":1e-05},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"host":{"pattern":"^http(s)?:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?$","type":"string"},"path":{"pattern":"^/[^?&]+$","type":"string"}}}},"hmac-auth":{"schema":{"title":"work with route or service object","type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"version":0.1,"consumer_schema":{"title":"work with consumer object","type":"object","required":["access_key","secret_key"],"encrypt_fields":["secret_key"],"properties":{"algorithm":{"type":"string","default":"hmac-sha256","enum":["hmac-sha1","hmac-sha256","hmac-sha512"]},"secret_key":{"minLength":1,"type":"string","maxLength":256},"clock_skew":{"default":0,"type":"integer"},"keep_headers":{"title":"whether to keep the http request header","type":"boolean","default":false},"encode_uri_params":{"title":"Whether to escape the uri parameter","type":"boolean","default":true},"validate_request_body":{"title":"A boolean value telling the plugin to enable body validation","type":"boolean","default":false},"max_req_body":{"title":"Max request body size","type":"integer","default":524288},"access_key":{"minLength":1,"type":"string","maxLength":256},"signed_headers":{"items":{"minLength":1,"type":"string","maxLength":50},"type":"array"}}},"type":"auth","priority":2530},"rocketmq-logger":{"version":0.1,"schema":{"required":["nameserver_list","topic"],"$comment":"this is a mark for our injected plugin schema","type":"object","encrypt_fields":["secret_key"],"properties":{"nameserver_list":{"minItems":1,"type":"array","items":{"type":"string"}},"use_tls":{"default":false,"type":"boolean"},"topic":{"type":"string"},"secret_key":{"default":"","type":"string"},"name":{"default":"rocketmq logger","type":"string"},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"include_resp_body":{"default":false,"type":"boolean"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"tag":{"type":"string"},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"retry_delay":{"type":"integer","default":1,"minimum":0},"key":{"type":"string"},"meta_format":{"type":"string","default":"default","enum":["default","origin"]},"timeout":{"type":"integer","default":3,"minimum":1},"access_key":{"default":"","type":"string"},"include_req_body":{"default":false,"type":"boolean"},"log_format":{"type":"object"},"include_req_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}}}},"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"priority":402},"tcp-logger":{"version":0.1,"priority":405,"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","port"],"properties":{"timeout":{"type":"integer","default":1000,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"tls":{"default":false,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"name":{"default":"tcp logger","type":"string"},"tls_options":{"type":"string"},"port":{"minimum":0,"type":"integer"},"include_req_body":{"default":false,"type":"boolean"},"host":{"type":"string"},"log_format":{"type":"object"}}}},"cors":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"allow_credential":{"type":"boolean","description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options.","default":false},"allow_origins":{"default":"*","type":"string","description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *.","pattern":"^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$"},"allow_origins_by_regex":{"type":"array","uniqueItems":true,"items":{"minLength":1,"type":"string","maxLength":4096},"minItems":1,"description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com] to allow a.test.com and b.test.com"},"allow_methods":{"type":"string","description":"you can use '*' to allow all methods when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *.","default":"*"},"max_age":{"type":"integer","description":"maximum number of seconds the results can be cached.-1 means no cached, the max value is depend on browser,more details plz check MDN. default: 5.","default":5},"allow_headers":{"type":"string","description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","default":"*"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"expose_headers":{"type":"string","description":"you can use '*' to expose all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","default":"*"},"allow_origins_by_metadata":{"type":"array","uniqueItems":true,"items":{"minLength":1,"type":"string","maxLength":4096},"minItems":1,"description":"set allowed origins by referencing origins in plugin metadata"}}},"metadata_schema":{"properties":{"allow_origins":{"additionalProperties":{"pattern":"^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$","type":"string"},"type":"object"}},"type":"object"},"priority":4000},"ext-plugin-post-resp":{"version":0.1,"priority":-4000,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"allow_degradation":{"default":false,"type":"boolean"},"conf":{"type":"array","minItems":1,"items":{"type":"object","required":["name","value"],"properties":{"name":{"minLength":1,"maxLength":128,"type":"string"},"value":{"type":"string"}}}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"request-id":{"version":0.1,"priority":12015,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"include_in_response":{"default":true,"type":"boolean"},"algorithm":{"type":"string","default":"uuid","enum":["uuid","snowflake","nanoid","range_id"]},"range_id":{"properties":{"length":{"type":"integer","default":16,"minimum":6},"char_set":{"minLength":6,"type":"string","default":"abcdefghijklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ0123456789"}},"type":"object"},"header_name":{"default":"X-Request-Id","type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"server-info":{"version":0.1,"priority":990,"scope":"global","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"authz-keycloak":{"version":0.1,"priority":2000,"schema":{"required":["client_id"],"allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}],"properties":{"lazy_load_paths":{"enum":[true]}}}]}],"$comment":"this is a mark for our injected plugin schema","type":"object","encrypt_fields":["client_secret"],"properties":{"timeout":{"type":"integer","default":3000,"minimum":1000},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"policy_enforcement_mode":{"type":"string","default":"ENFORCING","enum":["ENFORCING","PERMISSIVE"]},"permissions":{"default":{},"type":"array","uniqueItems":true,"items":{"minLength":1,"type":"string","maxLength":100}},"lazy_load_paths":{"default":false,"type":"boolean"},"discovery":{"minLength":1,"type":"string","maxLength":4096},"cache_ttl_seconds":{"type":"integer","default":86400,"minimum":1},"access_denied_redirect_uri":{"minLength":1,"type":"string","maxLength":2048},"refresh_token_expires_in":{"type":"integer","default":3600,"minimum":1},"refresh_token_expires_leeway":{"type":"integer","default":0,"minimum":0},"client_id":{"minLength":1,"type":"string","maxLength":100},"ssl_verify":{"default":true,"type":"boolean"},"keepalive":{"default":true,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"password_grant_token_generation_incoming_uri":{"minLength":1,"type":"string","maxLength":4096},"http_method_as_scope":{"default":false,"type":"boolean"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"grant_type":{"minLength":1,"type":"string","default":"urn:ietf:params:oauth:grant-type:uma-ticket","enum":["urn:ietf:params:oauth:grant-type:uma-ticket"],"maxLength":100},"token_endpoint":{"minLength":1,"type":"string","maxLength":4096},"access_token_expires_in":{"type":"integer","default":300,"minimum":1},"access_token_expires_leeway":{"type":"integer","default":0,"minimum":0},"client_secret":{"minLength":1,"type":"string","maxLength":100},"resource_registration_endpoint":{"minLength":1,"type":"string","maxLength":4096}}}},"proxy-control":{"version":0.1,"priority":21990,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"request_buffering":{"default":true,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"mocking":{"version":0.1,"priority":10900,"schema":{"anyOf":[{"required":["response_example"]},{"required":["response_schema"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"with_mock_header":{"default":true,"type":"boolean"},"delay":{"default":0,"type":"integer"},"content_type":{"default":"application/json;charset=utf8","type":"string"},"response_status":{"type":"integer","default":200,"minimum":100},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"response_example":{"type":"string"},"response_schema":{"type":"object"}}}},"ext-plugin-pre-req":{"version":0.1,"priority":12000,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"allow_degradation":{"default":false,"type":"boolean"},"conf":{"type":"array","minItems":1,"items":{"type":"object","required":["name","value"],"properties":{"name":{"minLength":1,"maxLength":128,"type":"string"},"value":{"type":"string"}}}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"real-ip":{"version":0.1,"priority":23000,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["source"],"properties":{"trusted_addresses":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}]}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"recursive":{"default":false,"type":"boolean"},"source":{"minLength":1,"type":"string"}}}},"google-cloud-logging":{"version":0.1,"priority":407,"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"schema":{"oneOf":[{"required":["auth_config"]},{"required":["auth_file"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","encrypt_fields":["auth_config.private_key"],"properties":{"resource":{"required":["type"],"type":"object","default":{"type":"global"},"properties":{"labels":{"type":"object"},"type":{"type":"string"}}},"log_format":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"ssl_verify":{"default":true,"type":"boolean"},"auth_config":{"type":"object","required":["private_key","project_id","token_uri"],"properties":{"token_uri":{"default":"https://oauth2.googleapis.com/token","type":"string"},"entries_uri":{"default":"https://logging.googleapis.com/v2/entries:write","type":"string"},"private_key":{"type":"string"},"scopes":{"type":"array","uniqueItems":true,"items":{"description":"Google OAuth2 Authorization Scopes","type":"string"},"minItems":1,"default":["https://www.googleapis.com/auth/logging.read","https://www.googleapis.com/auth/logging.write","https://www.googleapis.com/auth/logging.admin","https://www.googleapis.com/auth/cloud-platform"]},"project_id":{"type":"string"}}},"auth_file":{"type":"string"},"log_id":{"default":"apisix.apache.org%2Flogs","type":"string"},"name":{"default":"google-cloud-logging","type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"buffer_duration":{"type":"integer","default":60,"minimum":1},"retry_delay":{"type":"integer","default":1,"minimum":0}}}},"openwhisk":{"version":0.1,"priority":-1901,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["api_host","service_token","namespace","action"],"properties":{"package":{"maxLength":256,"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","type":"string"},"timeout":{"type":"integer","default":3000,"maximum":60000,"description":"timeout in milliseconds","minimum":1},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"ssl_verify":{"default":true,"type":"boolean"},"keepalive":{"default":true,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"namespace":{"maxLength":256,"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","type":"string"},"action":{"maxLength":256,"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","type":"string"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"result":{"default":true,"type":"boolean"},"service_token":{"type":"string"},"api_host":{"type":"string"}}}},"skywalking-logger":{"version":0.1,"priority":408,"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["endpoint_addr"],"properties":{"log_format":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"name":{"default":"skywalking logger","type":"string"},"endpoint_addr":{"pattern":"^[^\\/]+:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"timeout":{"type":"integer","default":3,"minimum":1},"include_req_body":{"default":false,"type":"boolean"},"service_name":{"default":"APISIX","type":"string"},"service_instance_name":{"default":"APISIX Instance Name","type":"string"}}}},"prometheus":{"version":0.2,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"prefer_name":{"default":false,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"priority":500},"loggly":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["customer_token"],"properties":{"include_resp_body":{"default":false,"type":"boolean"},"tags":{"type":"array","minItems":1,"default":["apisix"],"items":{"pattern":"^(?!tag=)[ -~]*","type":"string"}},"log_format":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"ssl_verify":{"default":true,"type":"boolean"},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"severity":{"description":"base severity log level","type":"string","default":"INFO","enum":["WARNING","warning","NOTICE","notice","INFO","info","DEBUG","debug","EMEGR","emegr","ALERT","alert","CRIT","crit","ERR","err"]},"name":{"default":"loggly","type":"string"},"retry_delay":{"type":"integer","default":1,"minimum":0},"severity_map":{"additionalProperties":false,"type":"object","description":"upstream response code vs syslog severity mapping","patternProperties":{"^[1-5][0-9]{2}$":{"type":"string","description":"keys are HTTP status code, values are severity","enum":["WARNING","warning","NOTICE","notice","INFO","info","DEBUG","debug","EMEGR","emegr","ALERT","alert","CRIT","crit","ERR","err"]}}},"include_req_body":{"default":false,"type":"boolean"},"customer_token":{"type":"string"},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}}}},"metadata_schema":{"properties":{"timeout":{"type":"integer","default":5000,"minimum":1},"protocol":{"type":"string","default":"syslog","enum":["syslog","http","https"]},"port":{"default":514,"type":"integer"},"host":{"default":"logs-01.loggly.com","type":"string"},"log_format":{"type":"object"}},"type":"object"},"priority":411},"sls-logger":{"version":0.1,"priority":406,"schema":{"required":["host","port","project","logstore","access_key_id","access_key_secret"],"$comment":"this is a mark for our injected plugin schema","type":"object","encrypt_fields":["access_key_secret"],"properties":{"inactive_timeout":{"type":"integer","default":5,"minimum":1},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"timeout":{"type":"integer","default":5000,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"host":{"type":"string"},"port":{"type":"integer"},"log_format":{"type":"object"},"name":{"default":"sls-logger","type":"string"},"include_req_body":{"default":false,"type":"boolean"},"project":{"type":"string"},"logstore":{"type":"string"},"access_key_id":{"type":"string"},"access_key_secret":{"type":"string"}}}},"tencent-cloud-cls":{"version":0.1,"schema":{"required":["cls_host","cls_topic","secret_id","secret_key"],"$comment":"this is a mark for our injected plugin schema","type":"object","encrypt_fields":["secret_key"],"properties":{"include_resp_body":{"default":false,"type":"boolean"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"log_format":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"secret_key":{"type":"string"},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"cls_host":{"type":"string"},"cls_topic":{"type":"string"},"secret_id":{"type":"string"},"sample_ratio":{"maximum":1,"type":"number","default":1,"minimum":1e-05},"retry_delay":{"type":"integer","default":1,"minimum":0},"include_req_body":{"default":false,"type":"boolean"},"name":{"default":"tencent-cloud-cls","type":"string"},"global_tag":{"type":"object"}}},"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"priority":397},"workflow":{"version":0.1,"priority":1006,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"rules":{"items":{"type":"object","required":["case","actions"],"properties":{"actions":{"items":{"minItems":1,"type":"array"},"type":"array"},"case":{"type":"array","minItems":1,"items":{"anyOf":[{"type":"array"},{"type":"string"}]}}}},"type":"array"}}}},"grpc-transcode":{"version":0.1,"schema":{"required":["proto_id","service","method"],"$comment":"this is a mark for our injected plugin schema","type":"object","additionalProperties":true,"properties":{"pb_option":{"minItems":1,"type":"array","default":["enum_as_name","int64_as_number","auto_default_values","disable_hooks"],"items":{"anyOf":[{"type":"string","description":"enum as result","enum":["int64_as_number","int64_as_string","int64_as_hexstring"]},{"type":"string","description":"int64 as result","enum":["enum_as_name","enum_as_value"]},{"type":"string","description":"default values option","enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"]},{"type":"string","description":"hooks option","enum":["enable_hooks","disable_hooks"]}],"type":"string"}},"method":{"description":"the method name in the grpc service.","type":"string"},"proto_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"service":{"description":"the grpc service name","type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"status_detail_type":{"description":"the message type of the grpc-status-details-bin's details part, if not given, the details part will not be decoded","type":"string"},"deadline":{"type":"number","description":"deadline for grpc, millisecond","default":0},"show_status_in_body":{"type":"boolean","description":"show decoded grpc-status-details-bin in response body","default":false}}},"priority":506},"ip-restriction":{"version":0.1,"priority":3000,"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"message":{"minLength":1,"type":"string","default":"Your IP address is not allowed","maxLength":1024},"blacklist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}]}},"whitelist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}]}}}}},"kafka-logger":{"version":0.1,"schema":{"oneOf":[{"required":["broker_list","kafka_topic"]},{"required":["brokers","kafka_topic"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"kafka_topic":{"type":"string"},"producer_type":{"type":"string","default":"async","enum":["async","sync"]},"required_acks":{"type":"integer","default":1,"enum":[0,1,-1]},"cluster_name":{"type":"integer","default":1,"minimum":1},"producer_batch_num":{"type":"integer","default":200,"minimum":1},"producer_batch_size":{"type":"integer","default":1048576,"minimum":0},"producer_max_buffering":{"type":"integer","default":50000,"minimum":1},"producer_time_linger":{"type":"integer","default":1,"minimum":1},"brokers":{"type":"array","minItems":1,"uniqueItems":true,"items":{"type":"object","required":["host","port"],"properties":{"port":{"maximum":65535,"type":"integer","description":"the port of kafka broker","minimum":1},"sasl_config":{"required":["user","password"],"type":"object","description":"sasl config","properties":{"user":{"description":"user","type":"string"},"mechanism":{"type":"string","default":"PLAIN","enum":["PLAIN"]},"password":{"description":"password","type":"string"}}},"host":{"description":"the host of kafka broker","type":"string"}}}},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"include_resp_body":{"default":false,"type":"boolean"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"broker_list":{"minProperties":1,"type":"object","patternProperties":{".*":{"maximum":65535,"type":"integer","description":"the port of kafka broker","minimum":1}}},"name":{"default":"kafka logger","type":"string"},"key":{"type":"string"},"meta_refresh_interval":{"type":"integer","default":30,"minimum":1},"meta_format":{"type":"string","default":"default","enum":["default","origin"]},"log_format":{"type":"object"},"include_req_body":{"default":false,"type":"boolean"},"timeout":{"type":"integer","default":3,"minimum":1},"include_req_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}}}},"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"priority":403},"cas-auth":{"version":0.1,"priority":2597,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["idp_uri","cas_callback_uri","logout_uri"],"properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"idp_uri":{"type":"string"},"cas_callback_uri":{"type":"string"},"logout_uri":{"type":"string"}}}},"serverless-pre-function":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["functions"],"properties":{"phase":{"type":"string","default":"access","enum":["rewrite","access","header_filter","body_filter","log","before_proxy"]},"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"priority":10000},"example-plugin":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["i"],"properties":{"t":{"minItems":1,"type":"array"},"i":{"minimum":0,"type":"number"},"port":{"type":"integer"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"ip":{"type":"string"},"s":{"type":"string"}}},"metadata_schema":{"type":"object","required":["ikey","skey"],"properties":{"skey":{"type":"string"},"ikey":{"minimum":0,"type":"number"}}},"priority":0},"serverless-post-function":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["functions"],"properties":{"phase":{"type":"string","default":"access","enum":["rewrite","access","header_filter","body_filter","log","before_proxy"]},"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"priority":-2000},"ldap-auth":{"schema":{"title":"work with route or service object","type":"object","$comment":"this is a mark for our injected plugin schema","required":["base_dn","ldap_uri"],"properties":{"base_dn":{"type":"string"},"ldap_uri":{"type":"string"},"uid":{"default":"cn","type":"string"},"tls_verify":{"default":false,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"use_tls":{"default":false,"type":"boolean"}}},"version":0.1,"consumer_schema":{"title":"work with consumer object","type":"object","required":["user_dn"],"properties":{"user_dn":{"type":"string"}}},"type":"auth","priority":2540},"uri-blocker":{"version":0.1,"priority":2900,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["block_rules"],"properties":{"block_rules":{"type":"array","uniqueItems":true,"items":{"minLength":1,"type":"string","maxLength":4096}},"case_insensitive":{"default":false,"type":"boolean"},"rejected_code":{"type":"integer","default":403,"minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"elasticsearch-logger":{"version":0.1,"priority":413,"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"schema":{"oneOf":[{"required":["endpoint_addr","field"]},{"required":["endpoint_addrs","field"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","encrypt_fields":["auth.password"],"properties":{"log_format":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"ssl_verify":{"default":true,"type":"boolean"},"buffer_duration":{"type":"integer","default":60,"minimum":1},"auth":{"type":"object","required":["username","password"],"properties":{"username":{"minLength":1,"type":"string"},"password":{"minLength":1,"type":"string"}}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"endpoint_addr":{"pattern":"[^/]$","type":"string"},"name":{"default":"elasticsearch-logger","type":"string"},"retry_delay":{"type":"integer","default":1,"minimum":0},"field":{"type":"object","required":["index"],"properties":{"index":{"type":"string"},"type":{"type":"string"}}},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"endpoint_addrs":{"minItems":1,"type":"array","items":{"pattern":"[^/]$","type":"string"}},"timeout":{"type":"integer","default":10,"minimum":1}}}},"syslog":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","port"],"properties":{"pool_size":{"type":"integer","default":5,"minimum":5},"timeout":{"type":"integer","default":3000,"minimum":1},"tls":{"default":false,"type":"boolean"},"flush_limit":{"type":"integer","default":4096,"minimum":1},"drop_limit":{"default":1048576,"type":"integer"},"sock_type":{"type":"string","default":"tcp","enum":["tcp","udp"]},"name":{"default":"sys logger","type":"string"},"port":{"type":"integer"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"log_format":{"type":"object"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"host":{"type":"string"},"include_req_body":{"default":false,"type":"boolean"}}},"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"priority":401},"proxy-rewrite":{"version":0.1,"priority":1008,"schema":{"minProperties":1,"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"method":{"type":"string","description":"proxy route method","enum":["HEAD","POST","PUT","DELETE","MKCOL","COPY","MOVE","OPTIONS","PROPFIND","LOCK","UNLOCK","PATCH","TRACE","GET"]},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"headers":{"description":"new headers for request","oneOf":[{"minProperties":1,"type":"object","additionalProperties":false,"properties":{"set":{"minProperties":1,"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}}},"remove":{"minItems":1,"type":"array","items":{"pattern":"^[^:]+$","type":"string"}},"add":{"minProperties":1,"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}}}}},{"minProperties":1,"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}}}]},"uri":{"minLength":1,"type":"string","pattern":"^\\/.*","description":"new uri for upstream","maxLength":4096},"use_real_request_uri_unsafe":{"type":"boolean","description":"use real_request_uri instead, THIS IS VERY UNSAFE.","default":false},"host":{"type":"string","description":"new host for upstream","pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$"},"regex_uri":{"type":"array","items":{"description":"regex uri","type":"string"},"minItems":2,"description":"new uri that substitute from client uri for upstream, lower priority than uri property","maxItems":2}}}},"gzip":{"version":0.1,"priority":995,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"vary":{"type":"boolean"},"types":{"anyOf":[{"minItems":1,"type":"array","items":{"minLength":1,"type":"string"}},{"enum":["*"]}],"default":["text/html"]},"http_version":{"default":1.1,"enum":[1.1,1]},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"buffers":{"type":"object","default":{"number":32,"size":4096},"properties":{"number":{"type":"integer","default":32,"minimum":1},"size":{"type":"integer","default":4096,"minimum":1}}},"min_length":{"type":"integer","default":20,"minimum":1},"comp_level":{"maximum":9,"type":"integer","default":1,"minimum":1}}}},"request-validation":{"version":0.1,"priority":2800,"type":"validation","schema":{"anyOf":[{"required":["header_schema"]},{"required":["body_schema"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"header_schema":{"type":"object"},"body_schema":{"type":"object"},"rejected_code":{"maximum":599,"type":"integer","default":400,"minimum":200},"rejected_msg":{"minLength":1,"type":"string","maxLength":256},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"splunk-hec-logging":{"version":0.1,"priority":409,"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["endpoint"],"properties":{"log_format":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"endpoint":{"type":"object","required":["uri","token"],"properties":{"uri":{"pattern":"^[^\\/]+:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"token":{"type":"string"},"timeout":{"type":"integer","default":10,"minimum":1},"channel":{"type":"string"}}},"name":{"default":"splunk-hec-logging","type":"string"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"ssl_verify":{"default":true,"type":"boolean"}}}},"proxy-cache":{"version":0.2,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"cache_zone":{"minLength":1,"type":"string","default":"disk_cache_one","maxLength":100},"cache_strategy":{"type":"string","default":"disk","enum":["disk","memory"]},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"cache_http_status":{"type":"array","uniqueItems":true,"items":{"maximum":599,"type":"integer","description":"http response status","minimum":200},"minItems":1,"default":[200,301,404]},"cache_key":{"type":"array","minItems":1,"default":["$host","$request_uri"],"items":{"type":"string","description":"a key for caching","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"}},"cache_method":{"type":"array","uniqueItems":true,"items":{"type":"string","description":"supported http method","enum":["GET","POST","HEAD"]},"minItems":1,"default":["GET","HEAD"]},"hide_cache_headers":{"default":false,"type":"boolean"},"cache_control":{"default":false,"type":"boolean"},"cache_bypass":{"minItems":1,"type":"array","items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"}},"no_cache":{"minItems":1,"type":"array","items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"}},"cache_ttl":{"type":"integer","default":300,"minimum":1}}},"priority":1009},"wolf-rbac":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"appid":{"default":"unset","type":"string"},"server":{"default":"http://127.0.0.1:12180","type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"header_prefix":{"default":"X-","type":"string"}}},"type":"auth","priority":2555},"jwt-auth":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"cookie":{"default":"jwt","type":"string"},"header":{"default":"authorization","type":"string"},"hide_credentials":{"default":false,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"query":{"default":"jwt","type":"string"}}},"version":0.1,"consumer_schema":{"type":"object","dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"default":"HS256","enum":["HS256","HS512"]}}},{"required":["public_key","private_key"],"properties":{"public_key":{"type":"string"},"private_key":{"type":"string"},"algorithm":{"enum":["RS256","ES256"]}}}]}},"required":["key"],"encrypt_fields":["secret","private_key"],"properties":{"key":{"type":"string"},"base64_secret":{"default":false,"type":"boolean"},"algorithm":{"type":"string","default":"HS256","enum":["HS256","HS512","RS256","ES256"]},"exp":{"type":"integer","default":86400,"minimum":1},"lifetime_grace_period":{"type":"integer","default":0,"minimum":0},"secret":{"type":"string"}}},"type":"auth","priority":2510},"azure-functions":{"version":0.1,"priority":-1900,"metadata_schema":{"properties":{"master_apikey":{"default":"","type":"string"},"master_clientid":{"default":"","type":"string"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["function_uri"],"properties":{"authorization":{"properties":{"apikey":{"type":"string"},"clientid":{"type":"string"}},"type":"object"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"timeout":{"type":"integer","default":3000,"minimum":100},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"function_uri":{"type":"string"},"keepalive":{"default":true,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"ssl_verify":{"default":true,"type":"boolean"}}}},"limit-count":{"version":0.4,"priority":1002,"schema":{"type":"object","then":{"required":["redis_host"],"properties":{"redis_timeout":{"type":"integer","default":1000,"minimum":1},"redis_host":{"minLength":2,"type":"string"},"redis_port":{"type":"integer","default":6379,"minimum":1},"redis_password":{"minLength":0,"type":"string"},"redis_database":{"type":"integer","default":0,"minimum":0}}},"required":["count","time_window"],"$comment":"this is a mark for our injected plugin schema","if":{"properties":{"policy":{"enum":["redis"]}}},"else":{"then":{"required":["redis_cluster_nodes","redis_cluster_name"],"properties":{"redis_timeout":{"type":"integer","default":1000,"minimum":1},"redis_cluster_nodes":{"minItems":2,"type":"array","items":{"minLength":2,"type":"string","maxLength":100}},"redis_cluster_name":{"type":"string"},"redis_cluster_ssl":{"default":false,"type":"boolean"},"redis_cluster_ssl_verify":{"default":false,"type":"boolean"},"redis_password":{"minLength":0,"type":"string"}}},"if":{"properties":{"policy":{"enum":["redis-cluster"]}}}},"properties":{"count":{"exclusiveMinimum":0,"type":"integer"},"policy":{"type":"string","default":"local","enum":["local","redis","redis-cluster"]},"key_type":{"type":"string","default":"var","enum":["var","var_combination","constant"]},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"key":{"default":"remote_addr","type":"string"},"group":{"type":"string"},"show_limit_quota_header":{"default":true,"type":"boolean"},"allow_degradation":{"default":false,"type":"boolean"},"rejected_code":{"maximum":599,"type":"integer","default":503,"minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"time_window":{"exclusiveMinimum":0,"type":"integer"}}}},"authz-casbin":{"version":0.1,"priority":2560,"metadata_schema":{"type":"object","required":["model","policy"],"properties":{"model":{"type":"string"},"policy":{"type":"string"}}},"schema":{"oneOf":[{"required":["model_path","policy_path","username"]},{"required":["model","policy","username"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"model_path":{"type":"string"},"policy_path":{"type":"string"},"model":{"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"policy":{"type":"string"},"username":{"type":"string"}}}},"limit-conn":{"version":0.1,"priority":1003,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["conn","burst","default_conn_delay","key"],"properties":{"conn":{"exclusiveMinimum":0,"type":"integer"},"default_conn_delay":{"exclusiveMinimum":0,"type":"number"},"key_type":{"type":"string","default":"var","enum":["var","var_combination"]},"key":{"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"only_use_default_delay":{"default":false,"type":"boolean"},"allow_degradation":{"default":false,"type":"boolean"},"rejected_code":{"maximum":599,"type":"integer","default":503,"minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"burst":{"minimum":0,"type":"integer"}}}},"redirect":{"version":0.1,"priority":900,"schema":{"oneOf":[{"required":["uri"]},{"required":["regex_uri"]},{"required":["http_to_https"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"encode_uri":{"default":false,"type":"boolean"},"http_to_https":{"type":"boolean"},"uri":{"minLength":2,"type":"string","pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)"},"append_query_string":{"default":false,"type":"boolean"},"ret_code":{"type":"integer","default":302,"minimum":200},"regex_uri":{"type":"array","items":{"description":"regex uri","type":"string"},"minItems":2,"description":"params for generating new uri that substitute from client uri, first param is regular expression, the second one is uri template","maxItems":2}}}},"grpc-web":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}},"priority":505},"public-api":{"version":0.1,"priority":501,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"uri":{"type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"limit-req":{"version":0.1,"priority":1001,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["rate","burst","key"],"properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"key_type":{"type":"string","default":"var","enum":["var","var_combination"]},"key":{"type":"string"},"burst":{"minimum":0,"type":"number"},"rate":{"exclusiveMinimum":0,"type":"number"},"allow_degradation":{"default":false,"type":"boolean"},"rejected_code":{"maximum":599,"type":"integer","default":503,"minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"nodelay":{"default":false,"type":"boolean"}}}},"ext-plugin-post-req":{"version":0.1,"priority":-3000,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"allow_degradation":{"default":false,"type":"boolean"},"conf":{"type":"array","minItems":1,"items":{"type":"object","required":["name","value"],"properties":{"name":{"minLength":1,"maxLength":128,"type":"string"},"value":{"type":"string"}}}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"clickhouse-logger":{"version":0.1,"schema":{"oneOf":[{"required":["endpoint_addr","user","password","database","logtable"]},{"required":["endpoint_addrs","user","password","database","logtable"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","encrypt_fields":["password"],"properties":{"timeout":{"type":"integer","default":3,"minimum":1},"name":{"default":"clickhouse-logger","type":"string"},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"include_resp_body":{"default":false,"type":"boolean"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"user":{"default":"","type":"string"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"endpoint_addrs":{"type":"array","minItems":1,"items":{"pattern":"^[^\\/]+:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"}},"database":{"default":"","type":"string"},"logtable":{"default":"","type":"string"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"ssl_verify":{"default":true,"type":"boolean"},"password":{"default":"","type":"string"},"endpoint_addr":{"pattern":"^[^\\/]+:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"include_req_body":{"default":false,"type":"boolean"},"log_format":{"type":"object"},"include_req_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}}}},"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"priority":398},"inspect":{"version":0.1,"priority":200,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"zipkin":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["endpoint","sample_ratio"],"properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"sample_ratio":{"type":"number","maximum":1,"minimum":1e-05},"span_version":{"default":2,"enum":[1,2]},"server_addr":{"type":"string","description":"default is $server_addr, you can specify your external ip address","pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$"},"service_name":{"type":"string","description":"service name for zipkin reporter","default":"APISIX"},"endpoint":{"type":"string"}}},"priority":12011},"echo":{"version":0.1,"priority":412,"schema":{"minProperties":1,"type":"object","anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"body":{"description":"body to replace upstream response.","type":"string"},"before_body":{"description":"body before the filter phase.","type":"string"},"headers":{"minProperties":1,"type":"object","description":"new headers for response"},"after_body":{"description":"body after the modification of filter phase.","type":"string"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}},"forward-auth":{"version":0.1,"priority":2002,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["uri"],"properties":{"timeout":{"type":"integer","default":3000,"maximum":60000,"description":"timeout in milliseconds","minimum":1},"request_headers":{"description":"client request header that will be sent to the authorization service","type":"array","default":{},"items":{"type":"string"}},"uri":{"type":"string"},"keepalive":{"default":true,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"request_method":{"description":"the method for client to request the authorization service","type":"string","default":"GET","enum":["GET","POST"]},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"ssl_verify":{"default":true,"type":"boolean"},"upstream_headers":{"description":"authorization response header that will be sent to the upstream","type":"array","default":{},"items":{"type":"string"}},"client_headers":{"description":"authorization response header that will be sent tothe client when authorizing failed","type":"array","default":{},"items":{"type":"string"}}}}},"aws-lambda":{"version":0.1,"priority":-1899,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["function_uri"],"properties":{"authorization":{"properties":{"apikey":{"type":"string"},"iam":{"type":"object","required":["accesskey","secretkey"],"properties":{"service":{"type":"string","default":"execute-api","description":"the service that is receiving the request"},"accesskey":{"description":"access key id from from aws iam console","type":"string"},"aws_region":{"type":"string","default":"us-east-1","description":"the aws region that is receiving the request"},"secretkey":{"description":"secret access key from from aws iam console","type":"string"}}}},"type":"object"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"timeout":{"type":"integer","default":3000,"minimum":100},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"function_uri":{"type":"string"},"keepalive":{"default":true,"type":"boolean"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"ssl_verify":{"default":true,"type":"boolean"}}}},"degraphql":{"version":0.1,"priority":509,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["query"],"properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"operation_name":{"minLength":1,"type":"string","maxLength":1024},"variables":{"type":"array","minItems":1,"items":{"type":"string"}},"query":{"minLength":1,"type":"string","maxLength":1024}}}},"csrf":{"version":0.1,"priority":2980,"schema":{"required":["key"],"$comment":"this is a mark for our injected plugin schema","type":"object","encrypt_fields":["key"],"properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"key":{"description":"use to generate csrf token","type":"string"},"expires":{"type":"integer","description":"expires time(s) for csrf token","default":7200},"name":{"type":"string","description":"the csrf token name","default":"apisix-csrf-token"}}}}},"stream_plugins":{"syslog":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["host","port"],"properties":{"pool_size":{"type":"integer","default":5,"minimum":5},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"timeout":{"type":"integer","default":3000,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"tls":{"default":false,"type":"boolean"},"flush_limit":{"type":"integer","default":4096,"minimum":1},"drop_limit":{"default":1048576,"type":"integer"},"sock_type":{"type":"string","default":"tcp","enum":["tcp","udp"]},"name":{"default":"stream sys logger","type":"string"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"port":{"type":"integer"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"host":{"type":"string"},"log_format":{"type":"object"}}},"metadata_schema":{"properties":{"log_format":{"default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"},"type":"object"}},"type":"object"},"priority":401},"limit-conn":{"version":0.1,"priority":1003,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["conn","burst","default_conn_delay","key"],"properties":{"conn":{"exclusiveMinimum":0,"type":"integer"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"key_type":{"type":"string","default":"var","enum":["var","var_combination"]},"key":{"type":"string"},"burst":{"minimum":0,"type":"integer"},"default_conn_delay":{"exclusiveMinimum":0,"type":"number"},"only_use_default_delay":{"default":false,"type":"boolean"}}}},"ip-restriction":{"version":0.1,"priority":3000,"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"},"message":{"minLength":1,"type":"string","default":"Your IP address is not allowed","maxLength":1024},"blacklist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}]}},"whitelist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}]}}}}},"mqtt-proxy":{"version":0.1,"priority":1000,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","required":["protocol_name","protocol_level"],"properties":{"protocol_name":{"type":"string"},"protocol_level":{"type":"integer"},"_meta":{"properties":{"disable":{"type":"boolean"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}},"type":"object"}}}}},"main":{"plugin_config":{"type":"object","required":["id","plugins"],"properties":{"plugins":{"type":"object"},"desc":{"maxLength":256,"type":"string"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"create_time":{"type":"integer"},"update_time":{"type":"integer"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"consumer_group":{"type":"object","required":["id","plugins"],"properties":{"plugins":{"type":"object"},"desc":{"maxLength":256,"type":"string"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"create_time":{"type":"integer"},"update_time":{"type":"integer"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"consumer":{"type":"object","required":["username"],"properties":{"plugins":{"type":"object"},"username":{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9_]+$","maxLength":100},"create_time":{"type":"integer"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"update_time":{"type":"integer"},"group_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"desc":{"maxLength":256,"type":"string"}}},"proto":{"type":"object","required":["content"],"properties":{"content":{"minLength":1,"type":"string","maxLength":1048576},"create_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"update_time":{"type":"integer"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"global_rule":{"type":"object","required":["plugins"],"properties":{"create_time":{"type":"integer"},"plugins":{"type":"object"},"update_time":{"type":"integer"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"upstream_hash_vars_schema":{"pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname)|arg_[0-9a-zA-z_-]+)$","type":"string"},"upstream_hash_header_schema":{"pattern":"^[a-zA-Z0-9-_]+$","type":"string"},"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","properties":{"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"}}},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}},"type":"object"},{"items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"type":"integer","description":"priority of node","default":0},"metadata":{"description":"metadata of node","type":"object"},"port":{"type":"integer","description":"port of node","minimum":1},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"type":"integer","description":"weight of node","minimum":0}}},"type":"array"}]},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"not":{"required":["client_cert_id"]},"required":["client_key"]},"client_key":{"not":{"required":["client_cert_id"]},"required":["client_cert"]}},"type":"object","properties":{"verify":{"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false},"client_key":{"minLength":128,"type":"string","maxLength":65536},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_cert_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"type":{"type":"string","description":"algorithms of load balancing","default":"roundrobin"},"name":{"minLength":1,"maxLength":100,"type":"string"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}},"type":"object"},"keepalive_pool":{"properties":{"requests":{"type":"integer","default":1000,"minimum":1},"idle_timeout":{"type":"number","default":60,"minimum":0},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"pass_host":{"default":"pass","type":"string","description":"mod of host passing","enum":["pass","node","rewrite"]},"create_time":{"type":"integer"},"scheme":{"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"]},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"active":{"properties":{"unhealthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"maximum":254,"type":"integer","default":3,"minimum":1},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":1},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":1}},"type":"object"},"req_headers":{"minItems":1,"type":"array","items":{"uniqueItems":true,"type":"string"}},"timeout":{"default":1,"type":"number"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"successes":{"maximum":254,"type":"integer","default":2,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,302]}},"type":"object"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"type":"integer","default":7,"minimum":0},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":0},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,500,503]},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":0}},"type":"object"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"maximum":254,"type":"integer","default":5,"minimum":0}},"type":"object"}},"type":"object"}}},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"service":{"properties":{"plugins":{"type":"object"},"script":{"minLength":10,"type":"string","maxLength":102400},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"hosts":{"minItems":1,"type":"array","uniqueItems":true,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"name":{"minLength":1,"maxLength":100,"type":"string"},"create_time":{"type":"integer"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","properties":{"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"}}},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}},"type":"object"},{"items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"type":"integer","description":"priority of node","default":0},"metadata":{"description":"metadata of node","type":"object"},"port":{"type":"integer","description":"port of node","minimum":1},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"type":"integer","description":"weight of node","minimum":0}}},"type":"array"}]},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"not":{"required":["client_cert_id"]},"required":["client_key"]},"client_key":{"not":{"required":["client_cert_id"]},"required":["client_cert"]}},"type":"object","properties":{"verify":{"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false},"client_key":{"minLength":128,"type":"string","maxLength":65536},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_cert_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"type":{"type":"string","description":"algorithms of load balancing","default":"roundrobin"},"name":{"minLength":1,"maxLength":100,"type":"string"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}},"type":"object"},"keepalive_pool":{"properties":{"requests":{"type":"integer","default":1000,"minimum":1},"idle_timeout":{"type":"number","default":60,"minimum":0},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"pass_host":{"default":"pass","type":"string","description":"mod of host passing","enum":["pass","node","rewrite"]},"create_time":{"type":"integer"},"scheme":{"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"]},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"active":{"properties":{"unhealthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"maximum":254,"type":"integer","default":3,"minimum":1},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":1},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":1}},"type":"object"},"req_headers":{"minItems":1,"type":"array","items":{"uniqueItems":true,"type":"string"}},"timeout":{"default":1,"type":"number"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"successes":{"maximum":254,"type":"integer","default":2,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,302]}},"type":"object"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"type":"integer","default":7,"minimum":0},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":0},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,500,503]},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":0}},"type":"object"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"maximum":254,"type":"integer","default":5,"minimum":0}},"type":"object"}},"type":"object"}}},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"upstream_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}},"type":"object"},"stream_route":{"properties":{"sni":{"type":"string","description":"server name indication","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"plugins":{"type":"object"},"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","properties":{"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"}}},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}},"type":"object"},{"items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"type":"integer","description":"priority of node","default":0},"metadata":{"description":"metadata of node","type":"object"},"port":{"type":"integer","description":"port of node","minimum":1},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"type":"integer","description":"weight of node","minimum":0}}},"type":"array"}]},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"not":{"required":["client_cert_id"]},"required":["client_key"]},"client_key":{"not":{"required":["client_cert_id"]},"required":["client_cert"]}},"type":"object","properties":{"verify":{"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false},"client_key":{"minLength":128,"type":"string","maxLength":65536},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_cert_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"type":{"type":"string","description":"algorithms of load balancing","default":"roundrobin"},"name":{"minLength":1,"maxLength":100,"type":"string"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}},"type":"object"},"keepalive_pool":{"properties":{"requests":{"type":"integer","default":1000,"minimum":1},"idle_timeout":{"type":"number","default":60,"minimum":0},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"pass_host":{"default":"pass","type":"string","description":"mod of host passing","enum":["pass","node","rewrite"]},"create_time":{"type":"integer"},"scheme":{"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"]},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"active":{"properties":{"unhealthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"maximum":254,"type":"integer","default":3,"minimum":1},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":1},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":1}},"type":"object"},"req_headers":{"minItems":1,"type":"array","items":{"uniqueItems":true,"type":"string"}},"timeout":{"default":1,"type":"number"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"successes":{"maximum":254,"type":"integer","default":2,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,302]}},"type":"object"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"type":"integer","default":7,"minimum":0},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":0},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,500,503]},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":0}},"type":"object"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"maximum":254,"type":"integer","default":5,"minimum":0}},"type":"object"}},"type":"object"}}},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"upstream_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"protocol":{"type":"object","required":["name"],"properties":{"conf":{"description":"protocol-specific configuration","type":"object"},"logger":{"items":{"dependencies":{"name":["conf"]},"properties":{"conf":{"description":"logger plugin configuration","type":"object"},"name":{"type":"string"},"filter":{"description":"logger filter rules","type":"array"}}},"type":"array"},"name":{"type":"string"},"superior_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"create_time":{"type":"integer"},"server_addr":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}],"type":"string","description":"server IP"},"remote_addr":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}],"type":"string","description":"client IP"},"server_port":{"description":"server port","type":"integer"}},"type":"object"},"plugins":{"items":{"type":"object","required":["name"],"properties":{"name":{"minLength":1,"type":"string"},"stream":{"type":"boolean"}}},"type":"array"},"ssl":{"type":"object","if":{"properties":{"type":{"enum":["server"]}}},"then":{"oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}]},"else":{"required":["key","cert"]},"properties":{"sni":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"client":{"type":"object","required":["ca"],"properties":{"depth":{"type":"integer","default":1,"minimum":0},"ca":{"minLength":128,"type":"string","maxLength":65536}}},"certs":{"items":{"minLength":128,"type":"string","maxLength":65536},"type":"array"},"cert":{"minLength":128,"type":"string","maxLength":65536},"status":{"default":1,"type":"integer","description":"ssl status, 1 to enable, 0 to disable","enum":[1,0]},"validity_start":{"type":"integer"},"validity_end":{"type":"integer"},"key":{"minLength":128,"type":"string","maxLength":65536},"type":{"default":"server","type":"string","description":"ssl certificate type, server to server certificate, client to client certificate for upstream","enum":["server","client"]},"exptime":{"minimum":1588262400,"type":"integer"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"snis":{"type":"array","minItems":1,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"keys":{"items":{"minLength":128,"type":"string","maxLength":65536},"type":"array"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"route":{"type":"object","allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}],"anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}],"not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]},"properties":{"plugins":{"type":"object"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"}}},"script":{"minLength":10,"type":"string","maxLength":102400},"status":{"default":1,"type":"integer","description":"route status, 1 to enable, 0 to disable","enum":[1,0]},"vars":{"type":"array"},"name":{"minLength":1,"maxLength":100,"type":"string"},"create_time":{"type":"integer"},"uris":{"minItems":1,"type":"array","uniqueItems":true,"items":{"description":"HTTP uri","type":"string"}},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"uri":{"minLength":1,"type":"string","maxLength":4096},"plugin_config_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"service_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"methods":{"type":"array","uniqueItems":true,"items":{"type":"string","description":"HTTP method","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"]}},"hosts":{"minItems":1,"type":"array","uniqueItems":true,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"remote_addrs":{"minItems":1,"type":"array","uniqueItems":true,"items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}],"type":"string","description":"client IP"}},"filter_func":{"minLength":10,"type":"string","pattern":"^function"},"desc":{"maxLength":256,"type":"string"},"script_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"priority":{"default":0,"type":"integer"},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"upstream":{"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object","properties":{"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"}}},"nodes":{"anyOf":[{"patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}},"type":"object"},{"items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"type":"integer","description":"priority of node","default":0},"metadata":{"description":"metadata of node","type":"object"},"port":{"type":"integer","description":"port of node","minimum":1},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"type":"integer","description":"weight of node","minimum":0}}},"type":"array"}]},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"not":{"required":["client_cert_id"]},"required":["client_key"]},"client_key":{"not":{"required":["client_cert_id"]},"required":["client_cert"]}},"type":"object","properties":{"verify":{"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false},"client_key":{"minLength":128,"type":"string","maxLength":65536},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_cert_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"type":{"type":"string","description":"algorithms of load balancing","default":"roundrobin"},"name":{"minLength":1,"maxLength":100,"type":"string"},"labels":{"type":"object","description":"key/value pairs to specify attributes","patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}}},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}},"type":"object"},"keepalive_pool":{"properties":{"requests":{"type":"integer","default":1000,"minimum":1},"idle_timeout":{"type":"number","default":60,"minimum":0},"size":{"type":"integer","default":320,"minimum":1}},"type":"object"},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"pass_host":{"default":"pass","type":"string","description":"mod of host passing","enum":["pass","node","rewrite"]},"create_time":{"type":"integer"},"scheme":{"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"]},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"active":{"properties":{"unhealthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505]},"timeouts":{"maximum":254,"type":"integer","default":3,"minimum":1},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":1},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":1}},"type":"object"},"req_headers":{"minItems":1,"type":"array","items":{"uniqueItems":true,"type":"string"}},"timeout":{"default":1,"type":"number"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"concurrency":{"default":10,"type":"integer"},"healthy":{"properties":{"interval":{"type":"integer","default":1,"minimum":1},"successes":{"maximum":254,"type":"integer","default":2,"minimum":1},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,302]}},"type":"object"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"http_path":{"default":"/","type":"string"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"type":"integer","default":7,"minimum":0},"http_failures":{"maximum":254,"type":"integer","default":5,"minimum":0},"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[429,500,503]},"tcp_failures":{"maximum":254,"type":"integer","default":2,"minimum":0}},"type":"object"},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"successes":{"maximum":254,"type":"integer","default":5,"minimum":0}},"type":"object"}},"type":"object"}}},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]}}},"upstream_id":{"anyOf":[{"minLength":1,"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64},{"minimum":1,"type":"integer"}]},"update_time":{"type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"remote_addr":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$"}],"type":"string","description":"client IP"}}}}}
